#!/usr/bin/perl -w

if (scalar(@ARGV) != 2)
{
	print "Kernelgen log summary\n";
	print "Usage: kgen-kernels-count <kernelgen.stats> <kind>\n";
	exit 0;
}

my($filename) = $ARGV[0];
my($kind1) = $ARGV[1];
my($kind2) = "F";

if ($kind1 eq "A")
{
	$kind1 = "\\w";
}

if ($kind1 eq "+")
{
	$kind1 = "\\+";
}

if ($kind1 eq "-")
{
	$kind1 = "\\-";
}

my(%kernels) = ();

my(@lines) = split("\n", `cat $filename`);
foreach $line (@lines)
{
	if ($line =~ m/^$kind1\t(?<NAME>\w+)/)
	{
		my($kernel) = $+{NAME};
		if (!exists($kernels{$kernel}))
		{
			$kernels{$kernel} = 1;
		}
	}
}
foreach $line (@lines)
{
	if ($line =~ m/^$kind2\t(?<NAME>\w+)/)
	{
		my($kernel) = $+{NAME};
		if (exists($kernels{$kernel}))
		{
			$kernels{$kernel} = 0;
		}
	}
}
foreach $kernel (keys %kernels)
{
	if ($kernels{$kernel} != 0)
	{
		print "$kernel\n";
	}
}

